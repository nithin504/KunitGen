ERROR:root:In file included from ../include/linux/device.h:15,

                 from ../include/linux/acpi.h:14,

                 from ../drivers/gpio/gpio-amdpt.c:14,

                 from ../drivers/gpio/new_2011_test.c:23:

../include/linux/dev_printk.h:155: warning: "dev_warn" redefined

  155 | #define dev_warn(dev, fmt, ...) \

      |

../drivers/gpio/new_2011_test.c:22: note: this is the location of the previous definition

   22 | #define dev_warn(dev, fmt, ...) printk(fmt, ##__VA_ARGS__)

      |

../include/linux/dev_printk.h:170: warning: "dev_dbg" redefined

  170 | #define dev_dbg(dev, fmt, ...)                                          \

      |

../drivers/gpio/new_2011_test.c:21: note: this is the location of the previous definition

   21 | #define dev_dbg(dev, fmt, ...) printk(fmt, ##__VA_ARGS__)

      |

../drivers/gpio/gpio-amdpt.c:25: warning: "PT_SYNC_REG" redefined

   25 | #define PT_SYNC_REG        0x28

      |

../drivers/gpio/new_2011_test.c:12: note: this is the location of the previous definition

   12 | #define PT_SYNC_REG 0x0

      |

../drivers/gpio/gpio-amdpt.c:27:8: error: redefinition of ‘struct pt_gpio_chip’

   27 | struct pt_gpio_chip {

      |        ^~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:8:8: note: originally defined here

    8 | struct pt_gpio_chip {

      |        ^~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:25:12: error: redefinition of ‘pt_gpio_request’

   25 | static int pt_gpio_request(struct gpio_chip *gc, unsigned offset)

      |            ^~~~~~~~~~~~~~~

../drivers/gpio/gpio-amdpt.c:32:12: note: previous definition of ‘pt_gpio_request’ with type ‘int(struct gpio_chip *, unsigned int)’

   32 | static int pt_gpio_request(struct gpio_chip *gc, unsigned offset)

      |            ^~~~~~~~~~~~~~~

In file included from ../include/linux/spinlock.h:314,

                 from ../include/linux/kref.h:16,

                 from ../include/kunit/test.h:22,

                 from ../drivers/gpio/new_2011_test.c:1:

../drivers/gpio/new_2011_test.c: In function ‘pt_gpio_request’:

../drivers/gpio/new_2011_test.c:33:34: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

   33 |         raw_spin_lock_irqsave(&gc->bgpio_lock, flags);

      |                                  ^~

../include/linux/spinlock_api_up.h:28:32: note: in definition of macro ‘___LOCK’

   28 |   do { __acquire(lock); (void)(lock); } while (0)

      |                                ^~~~

../include/linux/spinlock_api_up.h:40:31: note: in expansion of macro ‘__LOCK’

   40 |   do { local_irq_save(flags); __LOCK(lock); } while (0)

      |                               ^~~~~~

../include/linux/spinlock_api_up.h:69:49: note: in expansion of macro ‘__LOCK_IRQSAVE’

   69 | #define _raw_spin_lock_irqsave(lock, flags)     __LOCK_IRQSAVE(lock, flags)

      |                                                 ^~~~~~~~~~~~~~

../include/linux/spinlock.h:266:17: note: in expansion of macro ‘_raw_spin_lock_irqsave’

  266 |                 _raw_spin_lock_irqsave(lock, flags);    \

      |                 ^~~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:33:9: note: in expansion of macro ‘raw_spin_lock_irqsave’

   33 |         raw_spin_lock_irqsave(&gc->bgpio_lock, flags);

      |         ^~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:39:47: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

   39 |                 raw_spin_unlock_irqrestore(&gc->bgpio_lock, flags);

      |                                               ^~

../include/linux/spinlock_api_up.h:43:32: note: in definition of macro ‘___UNLOCK’

   43 |   do { __release(lock); (void)(lock); } while (0)

      |                                ^~~~

../include/linux/spinlock_api_up.h:56:34: note: in expansion of macro ‘__UNLOCK’

   56 |   do { local_irq_restore(flags); __UNLOCK(lock); } while (0)

      |                                  ^~~~~~~~

../include/linux/spinlock_api_up.h:86:41: note: in expansion of macro ‘__UNLOCK_IRQRESTORE’

   86 |                                         __UNLOCK_IRQRESTORE(lock, flags)

      |                                         ^~~~~~~~~~~~~~~~~~~

../include/linux/spinlock.h:282:17: note: in expansion of macro ‘_raw_spin_unlock_irqrestore’

  282 |                 _raw_spin_unlock_irqrestore(lock, flags);       \

      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:39:17: note: in expansion of macro ‘raw_spin_unlock_irqrestore’

   39 |                 raw_spin_unlock_irqrestore(&gc->bgpio_lock, flags);

      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:45:39: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

   45 |         raw_spin_unlock_irqrestore(&gc->bgpio_lock, flags);

      |                                       ^~

../include/linux/spinlock_api_up.h:43:32: note: in definition of macro ‘___UNLOCK’

   43 |   do { __release(lock); (void)(lock); } while (0)

      |                                ^~~~

../include/linux/spinlock_api_up.h:56:34: note: in expansion of macro ‘__UNLOCK’

   56 |   do { local_irq_restore(flags); __UNLOCK(lock); } while (0)

      |                                  ^~~~~~~~

../include/linux/spinlock_api_up.h:86:41: note: in expansion of macro ‘__UNLOCK_IRQRESTORE’

   86 |                                         __UNLOCK_IRQRESTORE(lock, flags)

      |                                         ^~~~~~~~~~~~~~~~~~~

../include/linux/spinlock.h:282:17: note: in expansion of macro ‘_raw_spin_unlock_irqrestore’

  282 |                 _raw_spin_unlock_irqrestore(lock, flags);       \

      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:45:9: note: in expansion of macro ‘raw_spin_unlock_irqrestore’

   45 |         raw_spin_unlock_irqrestore(&gc->bgpio_lock, flags);

      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_request_success’:

../drivers/gpio/new_2011_test.c:57:16: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

   57 |         mock_gc.bgpio_lock = __RAW_SPIN_LOCK_UNLOCKED(mock_gc.bgpio_lock);

      |                ^

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_request_pin_already_used’:

../drivers/gpio/new_2011_test.c:80:16: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

   80 |         mock_gc.bgpio_lock = __RAW_SPIN_LOCK_UNLOCKED(mock_gc.bgpio_lock);

      |                ^

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_request_different_pin’:

../drivers/gpio/new_2011_test.c:100:16: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

  100 |         mock_gc.bgpio_lock = __RAW_SPIN_LOCK_UNLOCKED(mock_gc.bgpio_lock);

      |                ^

make[5]: *** [../scripts/Makefile.build:287: drivers/gpio/new_2011_test.o] Error 1

make[4]: *** [../scripts/Makefile.build:556: drivers/gpio] Error 2

make[4]: *** Waiting for unfinished jobs....

make[3]: *** [../scripts/Makefile.build:556: drivers] Error 2

make[2]: *** [/home/tcsodc/linux-6.18-rc1/Makefile:2010: .] Error 2

make[1]: *** [/home/tcsodc/linux-6.18-rc1/Makefile:248: __sub-make] Error 2

make: *** [Makefile:248: __sub-make] Error 2
 
 
ERROR:root:../drivers/gpio/new_2011_test.c:9: warning: "ACPI_COMPANION" redefined

    9 | #define ACPI_COMPANION(dev) (mock_acpi_companion ? (void *)1 : NULL)

      |

In file included from ../drivers/gpio/new_2011_test.c:3:

../include/linux/acpi.h:57: note: this is the location of the previous definition

   57 | #define ACPI_COMPANION(dev)             to_acpi_device_node((dev)->fwnode)

      |

In file included from ../drivers/gpio/new_2011_test.c:19:

../drivers/gpio/gpio-amdpt.c:21: warning: "PT_DIRECTION_REG" redefined

   21 | #define PT_DIRECTION_REG   0x00

      |

../drivers/gpio/new_2011_test.c:14: note: this is the location of the previous definition

   14 | #define PT_DIRECTION_REG    0x08

      |

../drivers/gpio/gpio-amdpt.c:22: warning: "PT_INPUTDATA_REG" redefined

   22 | #define PT_INPUTDATA_REG   0x04

      |

../drivers/gpio/new_2011_test.c:12: note: this is the location of the previous definition

   12 | #define PT_INPUTDATA_REG    0x00

      |

../drivers/gpio/gpio-amdpt.c:23: warning: "PT_OUTPUTDATA_REG" redefined

   23 | #define PT_OUTPUTDATA_REG  0x08

      |

../drivers/gpio/new_2011_test.c:13: note: this is the location of the previous definition

   13 | #define PT_OUTPUTDATA_REG   0x04

      |

../drivers/gpio/gpio-amdpt.c:24: warning: "PT_CLOCKRATE_REG" redefined

   24 | #define PT_CLOCKRATE_REG   0x0C

      |

../drivers/gpio/new_2011_test.c:16: note: this is the location of the previous definition

   16 | #define PT_CLOCKRATE_REG    0x10

      |

../drivers/gpio/gpio-amdpt.c:25: warning: "PT_SYNC_REG" redefined

   25 | #define PT_SYNC_REG        0x28

      |

../drivers/gpio/new_2011_test.c:15: note: this is the location of the previous definition

   15 | #define PT_SYNC_REG         0x0C

      |

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_probe_success’:

../drivers/gpio/new_2011_test.c:68:9: error: implicit declaration of function ‘device_set_platform_data’; did you mean ‘device_get_match_data’? [-Werror=implicit-function-declaration]

   68 |         device_set_platform_data(&test_pt_gpio_pdev->dev, (void *)16); // ngpio = 16

      |         ^~~~~~~~~~~~~~~~~~~~~~~~

      |         device_get_match_data

../drivers/gpio/new_2011_test.c:63:32: warning: unused variable ‘dummy_driver’ [-Wunused-variable]

   63 |         struct platform_driver dummy_driver = {

      |                                ^~~~~~~~~~~~

In file included from ../include/linux/err.h:5,

                 from ../include/kunit/assert.h:12,

                 from ../include/kunit/test.h:12,

                 from ../drivers/gpio/new_2011_test.c:1:

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_probe_ioremap_failure’:

../include/linux/err.h:28:49: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]

   28 | #define IS_ERR_VALUE(x) unlikely((unsigned long)(void *)(x) >= (unsigned long)-MAX_ERRNO)

      |                                                 ^

../include/linux/compiler.h:76:45: note: in definition of macro ‘likely’

   76 | # define likely(x)      __builtin_expect(!!(x), 1)

      |                                             ^

../include/kunit/test.h:800:9: note: in expansion of macro ‘KUNIT_UNARY_ASSERTION’

  800 |         KUNIT_UNARY_ASSERTION(test,                                            \

      |         ^~~~~~~~~~~~~~~~~~~~~

../include/kunit/test.h:995:9: note: in expansion of macro ‘KUNIT_TRUE_MSG_ASSERTION’

  995 |         KUNIT_TRUE_MSG_ASSERTION(test,                                         \

      |         ^~~~~~~~~~~~~~~~~~~~~~~~

../include/kunit/test.h:992:9: note: in expansion of macro ‘KUNIT_EXPECT_TRUE_MSG’

  992 |         KUNIT_EXPECT_TRUE_MSG(test, condition, NULL)

      |         ^~~~~~~~~~~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:95:9: note: in expansion of macro ‘KUNIT_EXPECT_TRUE’

   95 |         KUNIT_EXPECT_TRUE(test, IS_ERR_VALUE(ret));

      |         ^~~~~~~~~~~~~~~~~

../include/linux/err.h:28:25: note: in expansion of macro ‘unlikely’

   28 | #define IS_ERR_VALUE(x) unlikely((unsigned long)(void *)(x) >= (unsigned long)-MAX_ERRNO)

      |                         ^~~~~~~~

../drivers/gpio/new_2011_test.c:95:33: note: in expansion of macro ‘IS_ERR_VALUE’

   95 |         KUNIT_EXPECT_TRUE(test, IS_ERR_VALUE(ret));

      |                                 ^~~~~~~~~~~~

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_probe_bgpio_init_failure’:

../include/linux/err.h:28:49: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]

   28 | #define IS_ERR_VALUE(x) unlikely((unsigned long)(void *)(x) >= (unsigned long)-MAX_ERRNO)

      |                                                 ^

../include/linux/compiler.h:77:45: note: in definition of macro ‘unlikely’

   77 | # define unlikely(x)    __builtin_expect(!!(x), 0)

      |                                             ^

../drivers/gpio/new_2011_test.c:110:14: note: in expansion of macro ‘IS_ERR_VALUE’

  110 |         if (!IS_ERR_VALUE(ret)) {

      |              ^~~~~~~~~~~~

cc1: some warnings being treated as errors

make[5]: *** [../scripts/Makefile.build:287: drivers/gpio/new_2011_test.o] Error 1

make[4]: *** [../scripts/Makefile.build:556: drivers/gpio] Error 2

make[4]: *** Waiting for unfinished jobs....

make[3]: *** [../scripts/Makefile.build:556: drivers] Error 2

make[2]: *** [/home/tcsodc/linux-6.18-rc1/Makefile:2010: .] Error 2

make[1]: *** [/home/tcsodc/linux-6.18-rc1/Makefile:248: __sub-make] Error 2

make: *** [Makefile:248: __sub-make] Error 2
 
 
Building with:

$ make all compile_commands.json scripts_gdb ARCH=x86_64 O=.kunit --jobs=16

ERROR:root:../drivers/gpio/new_2011_test.c:22:1: warning: ‘format’ attribute argument 2 value ‘3’ exceeds the number of function parameters 2 [-Wattributes]

   22 | {

      | ^

In file included from ../include/linux/device.h:15,

                 from ../include/linux/acpi.h:14,

                 from ../drivers/gpio/gpio-amdpt.c:14,

                 from ../drivers/gpio/new_2011_test.c:28:

../include/linux/dev_printk.h:170: warning: "dev_dbg" redefined

  170 | #define dev_dbg(dev, fmt, ...)                                          \

      |

../drivers/gpio/new_2011_test.c:25: note: this is the location of the previous definition

   25 | #define dev_dbg(dev, fmt, ...) stub_dev_dbg(dev, fmt, ##__VA_ARGS__)

      |

../drivers/gpio/gpio-amdpt.c:25: warning: "PT_SYNC_REG" redefined

   25 | #define PT_SYNC_REG        0x28

      |

../drivers/gpio/new_2011_test.c:11: note: this is the location of the previous definition

   11 | #define PT_SYNC_REG 0x0

      |

../drivers/gpio/gpio-amdpt.c:27:8: error: redefinition of ‘struct pt_gpio_chip’

   27 | struct pt_gpio_chip {

      |        ^~~~~~~~~~~~

../drivers/gpio/new_2011_test.c:7:8: note: originally defined here

    7 | struct pt_gpio_chip {

      |        ^~~~~~~~~~~~

../drivers/gpio/new_2011_test.c: In function ‘test_pt_gpio_free_basic’:

../drivers/gpio/new_2011_test.c:32:23: warning: unused variable ‘flags’ [-Wunused-variable]

   32 |         unsigned long flags;

      |                       ^~~~~

../drivers/gpio/new_2011_test.c: In function ‘pt_gpio_test_init’:

../drivers/gpio/new_2011_test.c:95:16: error: ‘struct gpio_chip’ has no member named ‘bgpio_lock’

   95 |         test_gc.bgpio_lock = __RAW_SPIN_LOCK_UNLOCKED(test_gc.bgpio_lock);

      |                ^

../drivers/gpio/new_2011_test.c:98:9: error: implicit declaration of function ‘gpiochip_set_data’; did you mean ‘gpiochip_get_data’? [-Werror=implicit-function-declaration]

   98 |         gpiochip_set_data(&test_gc, &test_pt_gpio_chip);

      |         ^~~~~~~~~~~~~~~~~

      |         gpiochip_get_data

../drivers/gpio/new_2011_test.c: At top level:

../drivers/gpio/new_2011_test.c:21:13: warning: ‘stub_dev_dbg’ defined but not used [-Wunused-function]

   21 | static void stub_dev_dbg(struct device *dev, const char *fmt, ...)

      |             ^~~~~~~~~~~~

cc1: some warnings being treated as errors

make[5]: *** [../scripts/Makefile.build:287: drivers/gpio/new_2011_test.o] Error 1

make[4]: *** [../scripts/Makefile.build:556: drivers/gpio] Error 2

make[4]: *** Waiting for unfinished jobs....

make[3]: *** [../scripts/Makefile.build:556: drivers] Error 2

make[2]: *** [/home/tcsodc/linux-6.18-rc1/Makefile:2010: .] Error 2

make[1]: *** [/home/tcsodc/linux-6.18-rc1/Makefile:248: __sub-make] Error 2

make: *** [Makefile:248: __sub-make] Error 2
 
root@tcsodc-Myrtle:/home/tcsodc/linux-6.18-rc1#

 
